Connected to the target VM, address: '127.0.0.1:55982', transport: 'socket'

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::               (v2.7.11)

2023-06-08 16:14:49 INFO  Version:21 - HV000001: Hibernate Validator 6.2.5.Final
2023-06-08 16:14:49 INFO  RatingApplication:55 - Starting RatingApplication using Java 11.0.18 on Nguyens-MacBook-Pro.local with PID 13512 (/Users/nhannd/workspace/aax3tm/rating/target/classes started by nhannd in /Users/nhannd/workspace/aax3tm)
2023-06-08 16:14:49 INFO  RatingApplication:631 - No active profile set, falling back to 1 default profile: "default"
2023-06-08 16:14:49 INFO  ConfigurationClassParser:468 - Properties location [classpath:business-logic.properties] not resolvable: class path resource [business-logic.properties] cannot be opened because it does not exist
2023-06-08 16:14:49 INFO  ConfigurationClassParser:468 - Properties location [file:${user.home}/.aax2cfg/business-logic.properties] not resolvable: /Users/nhannd/.aax2cfg/business-logic.properties (No such file or directory)
2023-06-08 16:14:49 INFO  ConfigurationClassParser:468 - Properties location [file:/vol1/aax2cfg/business-logic.properties] not resolvable: /vol1/aax2cfg/business-logic.properties (No such file or directory)
2023-06-08 16:14:49 INFO  ConfigurationClassParser:468 - Properties location [file:/vol1/aaxcfg/business-logic.properties] not resolvable: /vol1/aaxcfg/business-logic.properties (No such file or directory)
2023-06-08 16:14:49 INFO  ConfigurationClassParser:468 - Properties location [file:${user.home}/appconfig/dev-rating.properties] not resolvable: /Users/nhannd/appconfig/dev-rating.properties (No such file or directory)
2023-06-08 16:14:49 INFO  RepositoryConfigurationDelegate:132 - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2023-06-08 16:14:50 INFO  RepositoryConfigurationDelegate:201 - Finished Spring Data repository scanning in 343 ms. Found 288 JPA repository interfaces.
2023-06-08 16:14:51 INFO  TomcatWebServer:108 - Tomcat initialized with port(s): 8080 (http)
2023-06-08 16:14:51 INFO  Http11NioProtocol:173 - Initializing ProtocolHandler ["http-nio-8080"]
2023-06-08 16:14:51 INFO  StandardService:173 - Starting service [Tomcat]
2023-06-08 16:14:51 INFO  StandardEngine:173 - Starting Servlet engine: [Apache Tomcat/9.0.74]
2023-06-08 16:14:51 INFO  [/]:173 - Initializing Spring embedded WebApplicationContext
2023-06-08 16:14:51 INFO  ServletWebServerApplicationContext:292 - Root WebApplicationContext: initialization completed in 1796 ms
2023-06-08 16:14:51 INFO  LogHelper:31 - HHH000204: Processing PersistenceUnitInfo [name: default]
2023-06-08 16:14:51 INFO  Version:44 - HHH000412: Hibernate ORM core version 5.6.15.Final
2023-06-08 16:14:51 INFO  Version:56 - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2023-06-08 16:14:51 INFO  Dialect:175 - HHH000400: Using dialect: org.hibernate.dialect.PostgreSQLDialect
2023-06-08 16:15:00 INFO  JtaPlatformInitiator:52 - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2023-06-08 16:15:00 INFO  LocalContainerEntityManagerFactoryBean:437 - Initialized JPA EntityManagerFactory for persistence unit 'default'
2023-06-08 16:15:05 INFO  ApplicationConfig:25 - Initialized Rating Interface
2023-06-08 16:15:05 INFO  Version:41 - Redisson 3.17.5
2023-06-08 16:15:05 WARN  DnsServerAddressStreamProviders:70 - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
2023-06-08 16:15:06 INFO  MasterPubSubConnectionPool:158 - 1 connections initialized for localhost/127.0.0.1:6379
2023-06-08 16:15:06 INFO  MasterConnectionPool:158 - 24 connections initialized for localhost/127.0.0.1:6379
2023-06-08 16:15:10 INFO  TefEventListener:42 - Start listener on topic mmperf.ccs.usage.nnn
2023-06-08 16:15:13 WARN  JpaBaseConfiguration$JpaWebConfiguration:223 - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2023-06-08 16:15:14 INFO  EndpointLinksResolver:58 - Exposing 14 endpoint(s) beneath base path '/rating/actuator'
2023-06-08 16:15:14 INFO  Http11NioProtocol:173 - Starting ProtocolHandler ["http-nio-8080"]
2023-06-08 16:15:14 INFO  TomcatWebServer:220 - Tomcat started on port(s): 8080 (http) with context path ''
2023-06-08 16:15:14 INFO  HikariDataSource:110 - HikariPool-1 - Starting...
2023-06-08 16:15:14 INFO  RatingCache:231 - Evict itos cache
2023-06-08 16:15:16 INFO  HikariDataSource:123 - HikariPool-1 - Start completed.
2023-06-08 16:15:16 INFO  RatingCache:126 - Loading Prefixes
2023-06-08 16:15:37 INFO  RatingCache:137 - Finished loading Prefixes
2023-06-08 16:15:37 INFO  RatingCache:143 - Loading Ratings
2023-06-08 16:15:38 INFO  RatingCache:158 - Finished loading Ratings
2023-06-08 16:15:38 INFO  RatingCache:109 - Loading BalanceTemplates
2023-06-08 16:15:39 INFO  RatingCache:120 - Finished loading BalanceTemplates
2023-06-08 16:15:39 INFO  RatingCache:164 - Loading Prefixes 2 Callzones
2023-06-08 16:15:40 INFO  RatingCache:182 - Finished loading Prefixes 2 Callzones
2023-06-08 16:15:40 INFO  RatingCache:188 - Loading sservices TelephoneLine
2023-06-08 16:15:41 INFO  RatingCache:201 - Finished loading sservices TelephoneLine
2023-06-08 16:15:41 INFO  RatingCache:236 - Loading sPackage
2023-06-08 16:15:42 INFO  RatingCache:247 - Finished loading sPackage
2023-06-08 16:15:42 INFO  RatingCache:253 - Loading CallTypes
2023-06-08 16:15:44 INFO  RatingCache:258 - Finished loading CallTypes
2023-06-08 16:15:44 INFO  RatingCache:264 - Loading bMccMnc
2023-06-08 16:15:47 INFO  RatingCache:268 - Finished loading sPackage
2023-06-08 16:15:47 INFO  RatingCache:274 - Loading bCallOrigin
2023-06-08 16:15:47 INFO  RatingCache:278 - Finished loading sPackage
2023-06-08 16:15:47 INFO  RatingCache:284 - Loading bDestinationGroups
2023-06-08 16:15:49 INFO  RatingCache:289 - Finished loading bDestinationGroups
2023-06-08 16:15:49 INFO  RatingCache:295 - Loading bCallZones
2023-06-08 16:15:49 INFO  RatingCache:300 - Finished loading bCallZones
2023-06-08 16:15:49 INFO  RatingCache:306 - Loading rCountries
2023-06-08 16:15:51 INFO  RatingCache:310 - Finished loading rCountries
2023-06-08 16:15:51 INFO  RatingCache:316 - Loading rTaxIdentifiers
2023-06-08 16:15:52 INFO  RatingCache:320 - Finished loading rTaxIdentifiers
2023-06-08 16:15:52 INFO  RatingCache:326 - Loading sProductLineBrand
2023-06-08 16:15:53 INFO  RatingCache:330 - Finished loading sProductLineBrand
2023-06-08 16:15:54 INFO  DefaultUsageService:317 - Loading BUsage entries
mrmr2023-06-08 16:23:29 INFO  [/]:173 - Initializing Spring DispatcherServlet 'dispatcherServlet'
2023-06-08 16:23:29 INFO  DispatcherServlet:525 - Initializing Servlet 'dispatcherServlet'
2023-06-08 16:23:29 INFO  DispatcherServlet:547 - Completed initialization in 2 ms
2023-06-08 16:23:29 INFO  ConsumerConfig:376 - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.offset.reset = earliest
	bootstrap.servers = [tmperf-nodes.int.compax.at:9094]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ratingListener-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ratingListener
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2023-06-08 16:23:30 INFO  AppInfoParser:119 - Kafka version: 3.1.2
2023-06-08 16:23:30 INFO  AppInfoParser:120 - Kafka commitId: f8c67dc3ae0a3265
2023-06-08 16:23:30 INFO  AppInfoParser:121 - Kafka startTimeMs: 1686216210473
2023-06-08 16:23:30 INFO  KafkaConsumer:966 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Subscribed to topic(s): mmperf.ccs.usage.nnn, mmperf.ccs.usage_retry.nnn
2023-06-08 16:23:31 INFO  Metadata:402 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Resetting the last seen epoch of partition mmperf.ccs.usage_retry.nnn-0 to 0 since the associated topicId changed from null to 3ItCxyS7RP-ITym7g271wQ
2023-06-08 16:23:31 INFO  Metadata:402 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Resetting the last seen epoch of partition mmperf.ccs.usage.nnn-0 to 0 since the associated topicId changed from null to _L0gdI2BQKSFZCZkKswb_g
2023-06-08 16:23:31 INFO  Metadata:287 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Cluster ID: 2smA7iKYTjy8HODjSvkrMw
2023-06-08 16:23:31 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:23:31 INFO  ConsumerCoordinator:535 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] (Re-)joining group
2023-06-08 16:23:32 INFO  ConsumerCoordinator:1000 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Request joining group due to: need to re-join with the given member-id
2023-06-08 16:23:32 INFO  ConsumerCoordinator:535 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] (Re-)joining group
2023-06-08 16:23:32 INFO  ConsumerCoordinator:595 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Successfully joined group with generation Generation{generationId=32, memberId='consumer-ratingListener-1-f848687a-1b63-4579-ab1c-71f2a4bdbdd9', protocol='range'}
2023-06-08 16:23:32 INFO  ConsumerCoordinator:659 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Finished assignment for group at generation 32: {consumer-ratingListener-1-f848687a-1b63-4579-ab1c-71f2a4bdbdd9=Assignment(partitions=[mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0])}
2023-06-08 16:23:33 INFO  ConsumerCoordinator:761 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Successfully synced group in generation Generation{generationId=32, memberId='consumer-ratingListener-1-f848687a-1b63-4579-ab1c-71f2a4bdbdd9', protocol='range'}
2023-06-08 16:23:33 INFO  ConsumerCoordinator:280 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Notifying assignor about the new Assignment(partitions=[mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0])
2023-06-08 16:23:33 INFO  ConsumerCoordinator:292 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Adding newly assigned partitions: mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0
2023-06-08 16:23:33 INFO  ConsumerCoordinator:1405 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Found no committed offset for partition mmperf.ccs.usage_retry.nnn-0
2023-06-08 16:23:33 INFO  ConsumerCoordinator:851 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Setting offset for partition mmperf.ccs.usage.nnn-0 to the committed offset FetchPosition{offset=36, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[tmperf-nodes.int.compax.at:9094 (id: 0 rack: null)], epoch=0}}
2023-06-08 16:23:33 INFO  SubscriptionState:398 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Resetting offset for partition mmperf.ccs.usage_retry.nnn-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[tmperf-nodes.int.compax.at:9094 (id: 0 rack: null)], epoch=0}}.
2023-06-08 16:23:33 INFO  KafkaMessageListenerContainer:292 - ratingListener: partitions assigned: [mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0]
2023-06-08 16:23:54 INFO  TefEventListener:50 - ratingListener-0-C-1 Process Event Perf_1f67616f-1f44-4414-926b-099fb1867a13
2023-06-08 16:23:54 INFO  CDRTefEvent:141 - TEF_TEXT_EVENT
2023-06-08 16:23:55 INFO  TefPersistService:253 - Event 'TefTextEvent' with eventId 'Perf_1f67616f-1f44-4414-926b-099fb1867a13' saved
2023-06-08 16:23:56 INFO  RatingCache:253 - Loading CallTypes
2023-06-08 16:23:58 INFO  RatingCache:258 - Finished loading CallTypes
2023-06-08 16:23:58 INFO  RatingCache:109 - Loading BalanceTemplates
2023-06-08 16:23:58 INFO  RatingCache:120 - Finished loading BalanceTemplates
2023-06-08 16:23:58 INFO  RatingCache:316 - Loading rTaxIdentifiers
2023-06-08 16:23:59 INFO  RatingCache:320 - Finished loading rTaxIdentifiers
2023-06-08 16:23:59 INFO  RatingCache:284 - Loading bDestinationGroups
2023-06-08 16:23:59 INFO  RatingCache:289 - Finished loading bDestinationGroups
2023-06-08 16:23:59 INFO  RatingCache:326 - Loading sProductLineBrand
2023-06-08 16:24:00 INFO  RatingCache:330 - Finished loading sProductLineBrand
2023-06-08 16:24:00 INFO  RatingCache:295 - Loading bCallZones
2023-06-08 16:24:00 INFO  RatingCache:300 - Finished loading bCallZones
2023-06-08 16:24:00 INFO  RatingCache:306 - Loading rCountries
2023-06-08 16:24:01 INFO  RatingCache:310 - Finished loading rCountries
2023-06-08 16:24:01 INFO  RatingCache:274 - Loading bCallOrigin
2023-06-08 16:24:02 INFO  RatingCache:278 - Finished loading sPackage
2023-06-08 16:24:02 INFO  DefaultUsageService:162 - Found no matching usage config for Customer in 5096000 nanoseconds
2023-06-08 16:24:02 ERROR DefaultUsageService:79 - Error updating usage for UDR [at.compax.rating.core.UdrContext@738fb646]
java.lang.IllegalArgumentException: UDR has amount but no matching billing B_USAGE was found - UDR would not be billed!
EventId: Perf_1f67616f-1f44-4414-926b-099fb1867a13
Criteria: Call Type: TEF_TEXT_EVENT_MO [2006], Roaming: false, Origination Zone: OD [1], Destination Zone: DD [1], Destination Type: NM [12], Tenant: SP910 [3]
	at at.compax.rating.core.usage.DefaultUsageService.validateFoundBUsages(DefaultUsageService.java:124) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findMatchingUsage(DefaultUsageService.java:112) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findAndUpdateMatchingUsages(DefaultUsageService.java:88) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.assignAndUpdateUsage(DefaultUsageService.java:77) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService$$FastClassBySpringCGLIB$$2089b91d.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.usage.TefUsageService$$EnhancerBySpringCGLIB$$bb972458.assignAndUpdateUsage(<generated>) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline.rateCDRs(RatingPipeline.java:54) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline$$FastClassBySpringCGLIB$$f6e844a.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.core.RatingPipeline$$EnhancerBySpringCGLIB$$b3bbee39.rateCDRs(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.CDRTefEvent.process(CDRTefEvent.java:255) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent.run(TefTextEvent.java:22) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$FastClassBySpringCGLIB$$ca7d2e2b.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:24:34 WARN  HikariPool:788 - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=47s561ms).
2023-06-08 16:24:34 INFO  ConsumerCoordinator:1000 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Request joining group due to: group is already rebalancing
2023-06-08 16:24:35 ERROR TefPersistService:303 - UDR [Udr(uniqueId=null, startDate=2023-06-08T16:23:47.555879+07:00[Asia/Ho_Chi_Minh], endDate=null, usageType=at.compax.rating.core.models.CallType@5abe48e0, origin=OD [1], units=SMS, unitCount=600, preratedAmount=0.40, mobileData=at.compax.rating.core.MobileData@525361fd, telcoData=at.compax.rating.core.TelcoData@1307a14b, customData={tax_amount=0.08, isZeroRated=false, itemizedBillFormat=2, balanceTemplateInternal=AbstractPGBaseEntity(id=1000), roaming=false, isThrottledData=false, balanceTemplate=BalanceUpdate(amount=1.19, balanceClassId=978, balanceTemplateId=21065, grossAmountBefore=null, grossAmountAfter=null, balanceResourceId=3, balanceIntervalId=null), iddCCRegion=DD [1], tax_identifier=1, tax_rate=19, originationCCRegion=OD, duration=600.0, event_id=Perf_1f67616f-1f44-4414-926b-099fb1867a13, event_type=TEF_TEXT_EVENT, tenantId=SP910 [3], destinationType=NM [12], originationCCName=1, serviceId=SID_200228_1, subscriptionId=null, amount_gross=1.19}, rawId=null, version=0, refId=null, ratingDate=2023-06-08T16:23:56.145+07:00[Asia/Ho_Chi_Minh])] error in TefUsageService
java.lang.IllegalArgumentException: UDR has amount but no matching billing B_USAGE was found - UDR would not be billed!
EventId: Perf_1f67616f-1f44-4414-926b-099fb1867a13
Criteria: Call Type: TEF_TEXT_EVENT_MO [2006], Roaming: false, Origination Zone: OD [1], Destination Zone: DD [1], Destination Type: NM [12], Tenant: SP910 [3]
	at at.compax.rating.core.usage.DefaultUsageService.validateFoundBUsages(DefaultUsageService.java:124) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findMatchingUsage(DefaultUsageService.java:112) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findAndUpdateMatchingUsages(DefaultUsageService.java:88) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.assignAndUpdateUsage(DefaultUsageService.java:77) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService$$FastClassBySpringCGLIB$$2089b91d.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.usage.TefUsageService$$EnhancerBySpringCGLIB$$bb972458.assignAndUpdateUsage(<generated>) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline.rateCDRs(RatingPipeline.java:54) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline$$FastClassBySpringCGLIB$$f6e844a.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.core.RatingPipeline$$EnhancerBySpringCGLIB$$b3bbee39.rateCDRs(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.CDRTefEvent.process(CDRTefEvent.java:255) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent.run(TefTextEvent.java:22) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$FastClassBySpringCGLIB$$ca7d2e2b.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:45:01 WARN  HikariPool:788 - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=20m27s451ms).
2023-06-08 16:45:01 ERROR RatingPipeline:71 - java.lang.reflect.UndeclaredThrowableException
2023-06-08 16:45:01 INFO  NetworkClient:935 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Node 0 disconnected.
2023-06-08 16:45:01 INFO  NetworkClient:341 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Cancelled in-flight METADATA request with correlation id 49 due to node 0 being disconnected (elapsed time since creation: 10ms, elapsed time since send: 10ms, request timeout: 30000ms)
2023-06-08 16:45:01 INFO  NetworkClient:935 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Node 2147483647 disconnected.
2023-06-08 16:45:01 INFO  NetworkClient:935 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Node -1 disconnected.
2023-06-08 16:45:01 INFO  ConsumerCoordinator:916 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: true. Rediscovery will be attempted.
2023-06-08 16:45:01 INFO  RatingCache:231 - Evict itos cache
2023-06-08 16:45:02 ERROR TefEventListener:56 - ConsumerRecord(topic = mmperf.ccs.usage.nnn, partition = 0, leaderEpoch = 0, offset = 36, CreateTime = 1686216233374, serialized key size = -1, serialized value size = 4981, headers = RecordHeaders(headers = [], isReadOnly = false), key = null, value = {
  "accessNetworkInfo": "3GPP-E-UTRAN-FDD;utran-cell-id-3gpp=310010c94c18c8c19",
  "aggregationId": "0-1-19-472",
  "appliedCatalogItemArray": [
    {
      "catalogItemExternalId": "Paygo_Blau_BaseProduct_128",
      "catalogItemId": 128,
      "catalogItemResourceId": 1,
      "catalogItemTemplateAttr": {
        "mtx_container_name": "MtxTemplateAttr",
        "mtx_ext_ver": 2,
        "mtx_sys_ver": 5221
      },
      "mtx_container_name": "MtxEventAppliedCatalogItem",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221
    }
  ],
  "appliedOfferArray": [
    {
      "appliedBundleIndex": 0,
      "mtx_container_name": "MtxEventAppliedOffer",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "productOfferExternalId": "PAYGO_VOICE_179_OFFER",
      "productOfferExternalOwnerId": "Test_TEF_Sub_01",
      "productOfferId": 179,
      "productOfferOwnerId": "0-1-5-515",
      "productOfferResourceId": 3,
      "productOfferVersion": 0,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    }
  ],
  "appliedTaxArray": [
    {
      "externalId": "A2",
      "mtx_container_name": "MtxEventAppliedTax",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "name": "A2 - German Standard VAT",
      "rate": 0.19
    }
  ],
  "balanceUpdateArray": [
    {
      "amount": 1.19,
      "balanceClassId": 978,
      "balanceEndTime": "65535-12-31T23:59:59.999999Z",
      "balanceResourceId": 3,
      "balanceStartTime": "2022-03-06T14:46:35.000000+02:00",
      "balanceTemplateId": 21065,
      "flags": 40,
      "mtx_container_name": "MtxBalanceUpdate",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221
    }
  ],
  "calledStationId": "4911111122",
  "callingStationId": "491761234567",
  "deleteCode": 1,
  "destinationCountry": "Germany",
  "duration": 250,
  "eventTypeArray": [
    1,
    3,
    2
  ],
  "flags": 0,
  "iddCCName": "DEU",
  "imsi": 262071234567890,
  "initiatorDeviceExternalId": "Test_TEF_Device_01",
  "initiatorDeviceId": "0-1-5-517",
  "initiatorId": "0-1-5-515",
  "initiatorPrimaryUserExternalId": "Test_TEF_User_01",
  "initiatorPrimaryUserId": "0-1-5-511",
  "initiatorType": "subscription",
  "lastUsageRoundingAmount": 0.0,
  "mccMncToUse": "26223",
  "meterUpdateArray": [
    {
      "amount": 1.0,
      "mtx_container_name": "MtxEventUsageQuantity",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "templateId": "test"
    }
  ],
  "mscAddress": "17123456",
  "mtx_ext_ver": 2,
  "mtx_sys_ver": 5221,
  "op": 3,
  "originationCCName": "DEU",
  "originationCCNumber": "1",
  "ratingGroup": 0,
  "sessionId": "MATRIXX-QA-TESTING.;1;8531187",
  "sessionMsgId": 2,
  "streamCursor": "00000000000001537459:00000",
  "usageQuantityList": [
    {
      "flags": 1,
      "msgAmount": 600.0,
      "mtx_container_name": "MtxEventUsageQuantity",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "quantityType": "actual_duration",
      "quantityUnit": "seconds",
      "ratingAmount": 600.0
    }
  ],
  "usageRoundingAmount": 0.0,
  "usageRoundingAmountUnit": 100,
  "usageUtcOffset": 0,
  "walletId": "0-1-5-516",
  "walletOwnerExternalId": "wallet Owner",
  "walletOwnerId": "0-1-5-515",
  "walletOwnerType": "subscription",
  "chargeList": [
    {
      "amount": "0.40",
      "appliedOfferIndex": 0,
      "balanceUpdateIndex": 0,
      "impactSource": "product_offer",
      "mtx_container_name": "MtxEventCharge",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "paymentType": 1,
      "updateType": 1,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    },
    {
      "amount": "0.08",
      "appliedOfferIndex": 0,
      "appliedTaxIndex": 0,
      "balanceUpdateIndex": 0,
      "impactSource": "product_offer",
      "mtx_container_name": "MtxEventCharge",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "paymentType": 1,
      "updateType": 14,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    }
  ],
  "appliedBundleArray": [
    {
      "appliedCatalogItemIndex": 0,
      "bundleExternalId": "Paygo_Blau_BaseProduct_201_BUNDLE",
      "bundleId": 201,
      "bundleResourceId": 1,
      "bundleVersion": 0,
      "mtx_container_name": "MtxEventAppliedBundle",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "purchasedBundleAttr": {
        "epcProductId": "ABCD123456",
        "epcProductName": "Paygo Blau BaseProduct 1",
        "glCode": "100000",
        "mtx_container_name": "TefPurchasedItemExtension",
        "mtx_ext_ver": 2,
        "mtx_sys_ver": 5221,
        "productTaxCode": "A2",
        "purchaseSequence": "00001",
        "serviceInstanceId": "SID_200228_1",
        "speedProfile": "1"
      }
    }
  ],
  "eventTime": "2023-06-08T09:23:47.555879Z",
  "roamingFlagId": "false",
  "destinationTypeId": "NM",
  "originationCCRegion": "OD",
  "iddCCRegion": "DD",
  "mtx_container_name": "TefTextEvent",
  "callTypeId": "MO",
  "tenantId": "SP910",
  "eventId": "Perf_1f67616f-1f44-4414-926b-099fb1867a13"
})
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:752) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:654) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:407) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:45:03 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:03 WARN  ConsumerCoordinator:1408 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] consumer poll timeout has expired. This means the time between subsequent calls to poll() was longer than the configured max.poll.interval.ms, which typically implies that the poll loop is spending too much time processing messages. You can address this either by increasing max.poll.interval.ms or by reducing the maximum size of batches returned in poll() with max.poll.records.
2023-06-08 16:45:03 INFO  ConsumerCoordinator:1060 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Member consumer-ratingListener-1-f848687a-1b63-4579-ab1c-71f2a4bdbdd9 sending LeaveGroup request to coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null) due to consumer poll timeout has expired.
2023-06-08 16:45:03 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:03 INFO  ConsumerCoordinator:972 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Resetting generation due to: consumer pro-actively leaving the group
2023-06-08 16:45:03 INFO  ConsumerCoordinator:1000 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Request joining group due to: consumer pro-actively leaving the group
2023-06-08 16:45:04 ERROR RetryListener:64 - Persisted event Perf_1f67616f-1f44-4414-926b-099fb1867a13 for retry
2023-06-08 16:45:13 INFO  TefEventListener:50 - ratingListener-0-C-1 Process Event Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03
2023-06-08 16:45:13 INFO  CDRTefEvent:141 - TEF_TEXT_EVENT
2023-06-08 16:45:13 INFO  TefPersistService:253 - Event 'TefTextEvent' with eventId 'Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03' saved
2023-06-08 16:45:15 INFO  DefaultUsageService:162 - Found no matching usage config for Customer in 736000 nanoseconds
2023-06-08 16:45:15 ERROR DefaultUsageService:79 - Error updating usage for UDR [at.compax.rating.core.UdrContext@1ffbf6bb]
java.lang.IllegalArgumentException: UDR has amount but no matching billing B_USAGE was found - UDR would not be billed!
EventId: Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03
Criteria: Call Type: TEF_TEXT_EVENT_MO [2006], Roaming: false, Origination Zone: OD [1], Destination Zone: DD [1], Destination Type: NM [12], Tenant: SP910 [3]
	at at.compax.rating.core.usage.DefaultUsageService.validateFoundBUsages(DefaultUsageService.java:124) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findMatchingUsage(DefaultUsageService.java:112) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findAndUpdateMatchingUsages(DefaultUsageService.java:88) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.assignAndUpdateUsage(DefaultUsageService.java:77) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService$$FastClassBySpringCGLIB$$2089b91d.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.usage.TefUsageService$$EnhancerBySpringCGLIB$$bb972458.assignAndUpdateUsage(<generated>) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline.rateCDRs(RatingPipeline.java:54) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline$$FastClassBySpringCGLIB$$f6e844a.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.core.RatingPipeline$$EnhancerBySpringCGLIB$$b3bbee39.rateCDRs(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.CDRTefEvent.process(CDRTefEvent.java:255) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent.run(TefTextEvent.java:22) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$FastClassBySpringCGLIB$$ca7d2e2b.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:45:16 ERROR TefPersistService:303 - UDR [Udr(uniqueId=null, startDate=2023-06-08T16:23:53.387830+07:00[Asia/Ho_Chi_Minh], endDate=null, usageType=at.compax.rating.core.models.CallType@5abe48e0, origin=OD [1], units=SMS, unitCount=600, preratedAmount=0.44, mobileData=at.compax.rating.core.MobileData@215c6117, telcoData=at.compax.rating.core.TelcoData@1603c358, customData={tax_amount=0.08, isZeroRated=false, itemizedBillFormat=2, balanceTemplateInternal=AbstractPGBaseEntity(id=1000), roaming=false, isThrottledData=false, balanceTemplate=BalanceUpdate(amount=1.19, balanceClassId=978, balanceTemplateId=21065, grossAmountBefore=null, grossAmountAfter=null, balanceResourceId=3, balanceIntervalId=null), iddCCRegion=DD [1], tax_identifier=1, tax_rate=19, originationCCRegion=OD, duration=600.0, event_id=Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03, event_type=TEF_TEXT_EVENT, tenantId=SP910 [3], destinationType=NM [12], originationCCName=1, serviceId=SID_218839_1, subscriptionId=null, amount_gross=1.19}, rawId=null, version=0, refId=null, ratingDate=2023-06-08T16:45:14.662+07:00[Asia/Ho_Chi_Minh])] error in TefUsageService
java.lang.IllegalArgumentException: UDR has amount but no matching billing B_USAGE was found - UDR would not be billed!
EventId: Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03
Criteria: Call Type: TEF_TEXT_EVENT_MO [2006], Roaming: false, Origination Zone: OD [1], Destination Zone: DD [1], Destination Type: NM [12], Tenant: SP910 [3]
	at at.compax.rating.core.usage.DefaultUsageService.validateFoundBUsages(DefaultUsageService.java:124) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findMatchingUsage(DefaultUsageService.java:112) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findAndUpdateMatchingUsages(DefaultUsageService.java:88) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.assignAndUpdateUsage(DefaultUsageService.java:77) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService$$FastClassBySpringCGLIB$$2089b91d.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.usage.TefUsageService$$EnhancerBySpringCGLIB$$bb972458.assignAndUpdateUsage(<generated>) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline.rateCDRs(RatingPipeline.java:54) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline$$FastClassBySpringCGLIB$$f6e844a.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.core.RatingPipeline$$EnhancerBySpringCGLIB$$b3bbee39.rateCDRs(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.CDRTefEvent.process(CDRTefEvent.java:255) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent.run(TefTextEvent.java:22) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$FastClassBySpringCGLIB$$ca7d2e2b.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:45:16 ERROR RatingPipeline:71 - java.lang.reflect.UndeclaredThrowableException
2023-06-08 16:45:17 ERROR TefEventListener:56 - ConsumerRecord(topic = mmperf.ccs.usage.nnn, partition = 0, leaderEpoch = 0, offset = 37, CreateTime = 1686216233838, serialized key size = -1, serialized value size = 4981, headers = RecordHeaders(headers = [], isReadOnly = false), key = null, value = {
  "accessNetworkInfo": "3GPP-E-UTRAN-FDD;utran-cell-id-3gpp=310010c94c18c8c19",
  "aggregationId": "0-1-19-472",
  "appliedCatalogItemArray": [
    {
      "catalogItemExternalId": "Paygo_Blau_BaseProduct_128",
      "catalogItemId": 128,
      "catalogItemResourceId": 1,
      "catalogItemTemplateAttr": {
        "mtx_container_name": "MtxTemplateAttr",
        "mtx_ext_ver": 2,
        "mtx_sys_ver": 5221
      },
      "mtx_container_name": "MtxEventAppliedCatalogItem",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221
    }
  ],
  "appliedOfferArray": [
    {
      "appliedBundleIndex": 0,
      "mtx_container_name": "MtxEventAppliedOffer",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "productOfferExternalId": "PAYGO_VOICE_179_OFFER",
      "productOfferExternalOwnerId": "Test_TEF_Sub_01",
      "productOfferId": 179,
      "productOfferOwnerId": "0-1-5-515",
      "productOfferResourceId": 3,
      "productOfferVersion": 0,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    }
  ],
  "appliedTaxArray": [
    {
      "externalId": "A2",
      "mtx_container_name": "MtxEventAppliedTax",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "name": "A2 - German Standard VAT",
      "rate": 0.19
    }
  ],
  "balanceUpdateArray": [
    {
      "amount": 1.19,
      "balanceClassId": 978,
      "balanceEndTime": "65535-12-31T23:59:59.999999Z",
      "balanceResourceId": 3,
      "balanceStartTime": "2022-03-06T14:46:35.000000+02:00",
      "balanceTemplateId": 21065,
      "flags": 40,
      "mtx_container_name": "MtxBalanceUpdate",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221
    }
  ],
  "calledStationId": "4911111122",
  "callingStationId": "491761234567",
  "deleteCode": 1,
  "destinationCountry": "Germany",
  "duration": 250,
  "eventTypeArray": [
    1,
    3,
    2
  ],
  "flags": 0,
  "iddCCName": "DEU",
  "imsi": 262071234567890,
  "initiatorDeviceExternalId": "Test_TEF_Device_01",
  "initiatorDeviceId": "0-1-5-517",
  "initiatorId": "0-1-5-515",
  "initiatorPrimaryUserExternalId": "Test_TEF_User_01",
  "initiatorPrimaryUserId": "0-1-5-511",
  "initiatorType": "subscription",
  "lastUsageRoundingAmount": 0.0,
  "mccMncToUse": "26223",
  "meterUpdateArray": [
    {
      "amount": 1.0,
      "mtx_container_name": "MtxEventUsageQuantity",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "templateId": "test"
    }
  ],
  "mscAddress": "17123456",
  "mtx_ext_ver": 2,
  "mtx_sys_ver": 5221,
  "op": 3,
  "originationCCName": "DEU",
  "originationCCNumber": "1",
  "ratingGroup": 0,
  "sessionId": "MATRIXX-QA-TESTING.;1;8531187",
  "sessionMsgId": 2,
  "streamCursor": "00000000000001537459:00000",
  "usageQuantityList": [
    {
      "flags": 1,
      "msgAmount": 600.0,
      "mtx_container_name": "MtxEventUsageQuantity",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "quantityType": "actual_duration",
      "quantityUnit": "seconds",
      "ratingAmount": 600.0
    }
  ],
  "usageRoundingAmount": 0.0,
  "usageRoundingAmountUnit": 100,
  "usageUtcOffset": 0,
  "walletId": "0-1-5-516",
  "walletOwnerExternalId": "wallet Owner",
  "walletOwnerId": "0-1-5-515",
  "walletOwnerType": "subscription",
  "chargeList": [
    {
      "amount": "0.44",
      "appliedOfferIndex": 0,
      "balanceUpdateIndex": 0,
      "impactSource": "product_offer",
      "mtx_container_name": "MtxEventCharge",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "paymentType": 1,
      "updateType": 1,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    },
    {
      "amount": "0.08",
      "appliedOfferIndex": 0,
      "appliedTaxIndex": 0,
      "balanceUpdateIndex": 0,
      "impactSource": "product_offer",
      "mtx_container_name": "MtxEventCharge",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "paymentType": 1,
      "updateType": 14,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    }
  ],
  "appliedBundleArray": [
    {
      "appliedCatalogItemIndex": 0,
      "bundleExternalId": "Paygo_Blau_BaseProduct_201_BUNDLE",
      "bundleId": 201,
      "bundleResourceId": 1,
      "bundleVersion": 0,
      "mtx_container_name": "MtxEventAppliedBundle",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "purchasedBundleAttr": {
        "epcProductId": "ABCD123456",
        "epcProductName": "Paygo Blau BaseProduct 1",
        "glCode": "100000",
        "mtx_container_name": "TefPurchasedItemExtension",
        "mtx_ext_ver": 2,
        "mtx_sys_ver": 5221,
        "productTaxCode": "A2",
        "purchaseSequence": "00001",
        "serviceInstanceId": "SID_218839_1",
        "speedProfile": "1"
      }
    }
  ],
  "eventTime": "2023-06-08T09:23:53.387830Z",
  "roamingFlagId": "false",
  "destinationTypeId": "NM",
  "originationCCRegion": "OD",
  "iddCCRegion": "DD",
  "mtx_container_name": "TefTextEvent",
  "callTypeId": "MO",
  "tenantId": "SP910",
  "eventId": "Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03"
})
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:752) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:654) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:407) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:45:19 ERROR RetryListener:64 - Persisted event Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03 for retry
2023-06-08 16:45:19 INFO  ConsumerCoordinator:1171 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Failing OffsetCommit request since the consumer is not part of an active group
2023-06-08 16:45:19 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:19 ERROR KafkaMessageListenerContainer:149 - Consumer exception
java.lang.IllegalStateException: This error handler cannot process 'org.apache.kafka.clients.consumer.CommitFailedException's; no record information is available
	at org.springframework.kafka.listener.DefaultErrorHandler.handleOtherException(DefaultErrorHandler.java:157) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.handleConsumerException(KafkaMessageListenerContainer.java:1815) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1303) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
Caused by: org.apache.kafka.clients.consumer.CommitFailedException: Offset commit cannot be completed since the consumer is not part of an active group for auto partition assignment; it is likely that the consumer was kicked out of the group.
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.sendOffsetCommitRequest(ConsumerCoordinator.java:1180) ~[kafka-clients-3.1.2.jar:?]
	at org.apache.kafka.clients.consumer.internals.ConsumerCoordinator.commitOffsetsSync(ConsumerCoordinator.java:1045) ~[kafka-clients-3.1.2.jar:?]
	at org.apache.kafka.clients.consumer.KafkaConsumer.commitSync(KafkaConsumer.java:1492) ~[kafka-clients-3.1.2.jar:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213) ~[spring-aop-5.3.27.jar:5.3.27]
	at com.sun.proxy.$Proxy485.commitSync(Unknown Source) ~[?:?]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doCommitSync(KafkaMessageListenerContainer.java:3065) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.commitSync(KafkaMessageListenerContainer.java:3060) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.commitIfNecessary(KafkaMessageListenerContainer.java:3046) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.processCommits(KafkaMessageListenerContainer.java:2838) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1331) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	... 4 more
2023-06-08 16:45:19 INFO  ConsumerCoordinator:724 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
2023-06-08 16:45:19 INFO  ConsumerCoordinator:330 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Lost previously assigned partitions mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0
2023-06-08 16:45:19 INFO  KafkaMessageListenerContainer:292 - ratingListener: partitions lost: [mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0]
2023-06-08 16:45:19 INFO  KafkaMessageListenerContainer:292 - ratingListener: partitions revoked: [mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0]
2023-06-08 16:45:19 INFO  ConsumerCoordinator:535 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] (Re-)joining group
2023-06-08 16:45:19 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:19 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:19 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:19 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:19 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:19 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:19 INFO  ConsumerCoordinator:853 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Discovered group coordinator tmperf-nodes.int.compax.at:9094 (id: 2147483647 rack: null)
2023-06-08 16:45:19 ERROR ConsumerCoordinator:1098 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] LeaveGroup request with Generation{generationId=32, memberId='consumer-ratingListener-1-f848687a-1b63-4579-ab1c-71f2a4bdbdd9', protocol='range'} failed with error: The coordinator is not aware of this member.
2023-06-08 16:45:19 INFO  ConsumerCoordinator:1000 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Request joining group due to: need to re-join with the given member-id
2023-06-08 16:45:19 INFO  ConsumerCoordinator:535 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] (Re-)joining group
2023-06-08 16:45:19 INFO  ConsumerCoordinator:595 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Successfully joined group with generation Generation{generationId=39, memberId='consumer-ratingListener-1-1e142d0c-a874-466d-a0c1-44805c86dab1', protocol='range'}
2023-06-08 16:45:19 INFO  ConsumerCoordinator:659 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Finished assignment for group at generation 39: {consumer-ratingListener-1-1e142d0c-a874-466d-a0c1-44805c86dab1=Assignment(partitions=[mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0])}
2023-06-08 16:45:20 INFO  ConsumerCoordinator:761 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Successfully synced group in generation Generation{generationId=39, memberId='consumer-ratingListener-1-1e142d0c-a874-466d-a0c1-44805c86dab1', protocol='range'}
2023-06-08 16:45:20 INFO  ConsumerCoordinator:280 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Notifying assignor about the new Assignment(partitions=[mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0])
2023-06-08 16:45:20 INFO  ConsumerCoordinator:292 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Adding newly assigned partitions: mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0
2023-06-08 16:45:20 INFO  ConsumerCoordinator:1405 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Found no committed offset for partition mmperf.ccs.usage_retry.nnn-0
2023-06-08 16:45:20 INFO  ConsumerCoordinator:851 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Setting offset for partition mmperf.ccs.usage.nnn-0 to the committed offset FetchPosition{offset=36, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[tmperf-nodes.int.compax.at:9094 (id: 0 rack: null)], epoch=0}}
2023-06-08 16:45:20 INFO  SubscriptionState:398 - [Consumer clientId=consumer-ratingListener-1, groupId=ratingListener] Resetting offset for partition mmperf.ccs.usage_retry.nnn-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[tmperf-nodes.int.compax.at:9094 (id: 0 rack: null)], epoch=0}}.
2023-06-08 16:45:20 INFO  KafkaMessageListenerContainer:292 - ratingListener: partitions assigned: [mmperf.ccs.usage_retry.nnn-0, mmperf.ccs.usage.nnn-0]
2023-06-08 16:45:48 WARN  HikariPool:788 - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=46s707ms).
2023-06-08 16:45:48 INFO  TefEventListener:50 - ratingListener-0-C-1 Process Event Perf_1f67616f-1f44-4414-926b-099fb1867a13
2023-06-08 16:45:48 INFO  CDRTefEvent:141 - TEF_TEXT_EVENT
2023-06-08 16:45:49 INFO  TefPersistService:253 - Event 'TefTextEvent' with eventId 'Perf_1f67616f-1f44-4414-926b-099fb1867a13' saved
2023-06-08 16:45:50 INFO  DefaultUsageService:162 - Found no matching usage config for Customer in 1762000 nanoseconds
2023-06-08 16:45:50 ERROR DefaultUsageService:79 - Error updating usage for UDR [at.compax.rating.core.UdrContext@d96ac6a]
java.lang.IllegalArgumentException: UDR has amount but no matching billing B_USAGE was found - UDR would not be billed!
EventId: Perf_1f67616f-1f44-4414-926b-099fb1867a13
Criteria: Call Type: TEF_TEXT_EVENT_MO [2006], Roaming: false, Origination Zone: OD [1], Destination Zone: DD [1], Destination Type: NM [12], Tenant: SP910 [3]
	at at.compax.rating.core.usage.DefaultUsageService.validateFoundBUsages(DefaultUsageService.java:124) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findMatchingUsage(DefaultUsageService.java:112) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findAndUpdateMatchingUsages(DefaultUsageService.java:88) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.assignAndUpdateUsage(DefaultUsageService.java:77) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService$$FastClassBySpringCGLIB$$2089b91d.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.usage.TefUsageService$$EnhancerBySpringCGLIB$$bb972458.assignAndUpdateUsage(<generated>) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline.rateCDRs(RatingPipeline.java:54) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline$$FastClassBySpringCGLIB$$f6e844a.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.core.RatingPipeline$$EnhancerBySpringCGLIB$$b3bbee39.rateCDRs(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.CDRTefEvent.process(CDRTefEvent.java:255) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent.run(TefTextEvent.java:22) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$FastClassBySpringCGLIB$$ca7d2e2b.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:45:51 ERROR TefPersistService:303 - UDR [Udr(uniqueId=null, startDate=2023-06-08T16:23:47.555879+07:00[Asia/Ho_Chi_Minh], endDate=null, usageType=at.compax.rating.core.models.CallType@5abe48e0, origin=OD [1], units=SMS, unitCount=600, preratedAmount=0.40, mobileData=at.compax.rating.core.MobileData@31d388f, telcoData=at.compax.rating.core.TelcoData@642f6c9a, customData={tax_amount=0.08, isZeroRated=false, itemizedBillFormat=2, balanceTemplateInternal=AbstractPGBaseEntity(id=1000), roaming=false, isThrottledData=false, balanceTemplate=BalanceUpdate(amount=1.19, balanceClassId=978, balanceTemplateId=21065, grossAmountBefore=null, grossAmountAfter=null, balanceResourceId=3, balanceIntervalId=null), iddCCRegion=DD [1], tax_identifier=1, tax_rate=19, originationCCRegion=OD, duration=600.0, event_id=Perf_1f67616f-1f44-4414-926b-099fb1867a13, event_type=TEF_TEXT_EVENT, tenantId=SP910 [3], destinationType=NM [12], originationCCName=1, serviceId=SID_200228_1, subscriptionId=null, amount_gross=1.19}, rawId=null, version=0, refId=null, ratingDate=2023-06-08T16:45:49.995+07:00[Asia/Ho_Chi_Minh])] error in TefUsageService
java.lang.IllegalArgumentException: UDR has amount but no matching billing B_USAGE was found - UDR would not be billed!
EventId: Perf_1f67616f-1f44-4414-926b-099fb1867a13
Criteria: Call Type: TEF_TEXT_EVENT_MO [2006], Roaming: false, Origination Zone: OD [1], Destination Zone: DD [1], Destination Type: NM [12], Tenant: SP910 [3]
	at at.compax.rating.core.usage.DefaultUsageService.validateFoundBUsages(DefaultUsageService.java:124) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findMatchingUsage(DefaultUsageService.java:112) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findAndUpdateMatchingUsages(DefaultUsageService.java:88) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.assignAndUpdateUsage(DefaultUsageService.java:77) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService$$FastClassBySpringCGLIB$$2089b91d.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.usage.TefUsageService$$EnhancerBySpringCGLIB$$bb972458.assignAndUpdateUsage(<generated>) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline.rateCDRs(RatingPipeline.java:54) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline$$FastClassBySpringCGLIB$$f6e844a.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.core.RatingPipeline$$EnhancerBySpringCGLIB$$b3bbee39.rateCDRs(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.CDRTefEvent.process(CDRTefEvent.java:255) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent.run(TefTextEvent.java:22) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$FastClassBySpringCGLIB$$ca7d2e2b.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:45:51 ERROR RatingPipeline:71 - java.lang.reflect.UndeclaredThrowableException
2023-06-08 16:45:52 ERROR TefEventListener:56 - ConsumerRecord(topic = mmperf.ccs.usage.nnn, partition = 0, leaderEpoch = 0, offset = 36, CreateTime = 1686216233374, serialized key size = -1, serialized value size = 4981, headers = RecordHeaders(headers = [], isReadOnly = false), key = null, value = {
  "accessNetworkInfo": "3GPP-E-UTRAN-FDD;utran-cell-id-3gpp=310010c94c18c8c19",
  "aggregationId": "0-1-19-472",
  "appliedCatalogItemArray": [
    {
      "catalogItemExternalId": "Paygo_Blau_BaseProduct_128",
      "catalogItemId": 128,
      "catalogItemResourceId": 1,
      "catalogItemTemplateAttr": {
        "mtx_container_name": "MtxTemplateAttr",
        "mtx_ext_ver": 2,
        "mtx_sys_ver": 5221
      },
      "mtx_container_name": "MtxEventAppliedCatalogItem",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221
    }
  ],
  "appliedOfferArray": [
    {
      "appliedBundleIndex": 0,
      "mtx_container_name": "MtxEventAppliedOffer",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "productOfferExternalId": "PAYGO_VOICE_179_OFFER",
      "productOfferExternalOwnerId": "Test_TEF_Sub_01",
      "productOfferId": 179,
      "productOfferOwnerId": "0-1-5-515",
      "productOfferResourceId": 3,
      "productOfferVersion": 0,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    }
  ],
  "appliedTaxArray": [
    {
      "externalId": "A2",
      "mtx_container_name": "MtxEventAppliedTax",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "name": "A2 - German Standard VAT",
      "rate": 0.19
    }
  ],
  "balanceUpdateArray": [
    {
      "amount": 1.19,
      "balanceClassId": 978,
      "balanceEndTime": "65535-12-31T23:59:59.999999Z",
      "balanceResourceId": 3,
      "balanceStartTime": "2022-03-06T14:46:35.000000+02:00",
      "balanceTemplateId": 21065,
      "flags": 40,
      "mtx_container_name": "MtxBalanceUpdate",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221
    }
  ],
  "calledStationId": "4911111122",
  "callingStationId": "491761234567",
  "deleteCode": 1,
  "destinationCountry": "Germany",
  "duration": 250,
  "eventTypeArray": [
    1,
    3,
    2
  ],
  "flags": 0,
  "iddCCName": "DEU",
  "imsi": 262071234567890,
  "initiatorDeviceExternalId": "Test_TEF_Device_01",
  "initiatorDeviceId": "0-1-5-517",
  "initiatorId": "0-1-5-515",
  "initiatorPrimaryUserExternalId": "Test_TEF_User_01",
  "initiatorPrimaryUserId": "0-1-5-511",
  "initiatorType": "subscription",
  "lastUsageRoundingAmount": 0.0,
  "mccMncToUse": "26223",
  "meterUpdateArray": [
    {
      "amount": 1.0,
      "mtx_container_name": "MtxEventUsageQuantity",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "templateId": "test"
    }
  ],
  "mscAddress": "17123456",
  "mtx_ext_ver": 2,
  "mtx_sys_ver": 5221,
  "op": 3,
  "originationCCName": "DEU",
  "originationCCNumber": "1",
  "ratingGroup": 0,
  "sessionId": "MATRIXX-QA-TESTING.;1;8531187",
  "sessionMsgId": 2,
  "streamCursor": "00000000000001537459:00000",
  "usageQuantityList": [
    {
      "flags": 1,
      "msgAmount": 600.0,
      "mtx_container_name": "MtxEventUsageQuantity",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "quantityType": "actual_duration",
      "quantityUnit": "seconds",
      "ratingAmount": 600.0
    }
  ],
  "usageRoundingAmount": 0.0,
  "usageRoundingAmountUnit": 100,
  "usageUtcOffset": 0,
  "walletId": "0-1-5-516",
  "walletOwnerExternalId": "wallet Owner",
  "walletOwnerId": "0-1-5-515",
  "walletOwnerType": "subscription",
  "chargeList": [
    {
      "amount": "0.40",
      "appliedOfferIndex": 0,
      "balanceUpdateIndex": 0,
      "impactSource": "product_offer",
      "mtx_container_name": "MtxEventCharge",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "paymentType": 1,
      "updateType": 1,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    },
    {
      "amount": "0.08",
      "appliedOfferIndex": 0,
      "appliedTaxIndex": 0,
      "balanceUpdateIndex": 0,
      "impactSource": "product_offer",
      "mtx_container_name": "MtxEventCharge",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "paymentType": 1,
      "updateType": 14,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    }
  ],
  "appliedBundleArray": [
    {
      "appliedCatalogItemIndex": 0,
      "bundleExternalId": "Paygo_Blau_BaseProduct_201_BUNDLE",
      "bundleId": 201,
      "bundleResourceId": 1,
      "bundleVersion": 0,
      "mtx_container_name": "MtxEventAppliedBundle",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "purchasedBundleAttr": {
        "epcProductId": "ABCD123456",
        "epcProductName": "Paygo Blau BaseProduct 1",
        "glCode": "100000",
        "mtx_container_name": "TefPurchasedItemExtension",
        "mtx_ext_ver": 2,
        "mtx_sys_ver": 5221,
        "productTaxCode": "A2",
        "purchaseSequence": "00001",
        "serviceInstanceId": "SID_200228_1",
        "speedProfile": "1"
      }
    }
  ],
  "eventTime": "2023-06-08T09:23:47.555879Z",
  "roamingFlagId": "false",
  "destinationTypeId": "NM",
  "originationCCRegion": "OD",
  "iddCCRegion": "DD",
  "mtx_container_name": "TefTextEvent",
  "callTypeId": "MO",
  "tenantId": "SP910",
  "eventId": "Perf_1f67616f-1f44-4414-926b-099fb1867a13"
})
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:752) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:654) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:407) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:45:54 ERROR RetryListener:64 - Persisted event Perf_1f67616f-1f44-4414-926b-099fb1867a13 for retry
2023-06-08 16:45:54 INFO  TefEventListener:50 - ratingListener-0-C-1 Process Event Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03
2023-06-08 16:45:59 INFO  CDRTefEvent:141 - TEF_TEXT_EVENT
2023-06-08 16:46:00 INFO  TefPersistService:253 - Event 'TefTextEvent' with eventId 'Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03' saved
2023-06-08 16:46:01 INFO  DefaultUsageService:162 - Found no matching usage config for Customer in 2180000 nanoseconds
2023-06-08 16:46:01 ERROR DefaultUsageService:79 - Error updating usage for UDR [at.compax.rating.core.UdrContext@3eb8bfd3]
java.lang.IllegalArgumentException: UDR has amount but no matching billing B_USAGE was found - UDR would not be billed!
EventId: Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03
Criteria: Call Type: TEF_TEXT_EVENT_MO [2006], Roaming: false, Origination Zone: OD [1], Destination Zone: DD [1], Destination Type: NM [12], Tenant: SP910 [3]
	at at.compax.rating.core.usage.DefaultUsageService.validateFoundBUsages(DefaultUsageService.java:124) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findMatchingUsage(DefaultUsageService.java:112) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findAndUpdateMatchingUsages(DefaultUsageService.java:88) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.assignAndUpdateUsage(DefaultUsageService.java:77) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService$$FastClassBySpringCGLIB$$2089b91d.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.usage.TefUsageService$$EnhancerBySpringCGLIB$$bb972458.assignAndUpdateUsage(<generated>) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline.rateCDRs(RatingPipeline.java:54) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline$$FastClassBySpringCGLIB$$f6e844a.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.core.RatingPipeline$$EnhancerBySpringCGLIB$$b3bbee39.rateCDRs(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.CDRTefEvent.process(CDRTefEvent.java:255) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent.run(TefTextEvent.java:22) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$FastClassBySpringCGLIB$$ca7d2e2b.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:46:07 ERROR TefPersistService:303 - UDR [Udr(uniqueId=null, startDate=2023-06-08T16:23:53.387830+07:00[Asia/Ho_Chi_Minh], endDate=null, usageType=at.compax.rating.core.models.CallType@5abe48e0, origin=OD [1], units=SMS, unitCount=600, preratedAmount=0.44, mobileData=at.compax.rating.core.MobileData@4c6c103c, telcoData=at.compax.rating.core.TelcoData@4ce65e0b, customData={tax_amount=0.08, isZeroRated=false, itemizedBillFormat=2, balanceTemplateInternal=AbstractPGBaseEntity(id=1000), roaming=false, isThrottledData=false, balanceTemplate=BalanceUpdate(amount=1.19, balanceClassId=978, balanceTemplateId=21065, grossAmountBefore=null, grossAmountAfter=null, balanceResourceId=3, balanceIntervalId=null), iddCCRegion=DD [1], tax_identifier=1, tax_rate=19, originationCCRegion=OD, duration=600.0, event_id=Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03, event_type=TEF_TEXT_EVENT, tenantId=SP910 [3], destinationType=NM [12], originationCCName=1, serviceId=SID_218839_1, subscriptionId=null, amount_gross=1.19}, rawId=null, version=0, refId=null, ratingDate=2023-06-08T16:46:00.725+07:00[Asia/Ho_Chi_Minh])] error in TefUsageService
java.lang.IllegalArgumentException: UDR has amount but no matching billing B_USAGE was found - UDR would not be billed!
EventId: Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03
Criteria: Call Type: TEF_TEXT_EVENT_MO [2006], Roaming: false, Origination Zone: OD [1], Destination Zone: DD [1], Destination Type: NM [12], Tenant: SP910 [3]
	at at.compax.rating.core.usage.DefaultUsageService.validateFoundBUsages(DefaultUsageService.java:124) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findMatchingUsage(DefaultUsageService.java:112) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.findAndUpdateMatchingUsages(DefaultUsageService.java:88) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService.assignAndUpdateUsage(DefaultUsageService.java:77) ~[classes/:?]
	at at.compax.rating.core.usage.DefaultUsageService$$FastClassBySpringCGLIB$$2089b91d.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.usage.TefUsageService$$EnhancerBySpringCGLIB$$bb972458.assignAndUpdateUsage(<generated>) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline.rateCDRs(RatingPipeline.java:54) ~[classes/:?]
	at at.compax.rating.core.RatingPipeline$$FastClassBySpringCGLIB$$f6e844a.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.core.RatingPipeline$$EnhancerBySpringCGLIB$$b3bbee39.rateCDRs(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.CDRTefEvent.process(CDRTefEvent.java:255) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent.run(TefTextEvent.java:22) ~[classes/:?]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$FastClassBySpringCGLIB$$ca7d2e2b.invoke(<generated>) ~[classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:46:12 ERROR RatingPipeline:71 - java.lang.reflect.UndeclaredThrowableException
2023-06-08 16:46:13 ERROR TefEventListener:56 - ConsumerRecord(topic = mmperf.ccs.usage.nnn, partition = 0, leaderEpoch = 0, offset = 37, CreateTime = 1686216233838, serialized key size = -1, serialized value size = 4981, headers = RecordHeaders(headers = [], isReadOnly = false), key = null, value = {
  "accessNetworkInfo": "3GPP-E-UTRAN-FDD;utran-cell-id-3gpp=310010c94c18c8c19",
  "aggregationId": "0-1-19-472",
  "appliedCatalogItemArray": [
    {
      "catalogItemExternalId": "Paygo_Blau_BaseProduct_128",
      "catalogItemId": 128,
      "catalogItemResourceId": 1,
      "catalogItemTemplateAttr": {
        "mtx_container_name": "MtxTemplateAttr",
        "mtx_ext_ver": 2,
        "mtx_sys_ver": 5221
      },
      "mtx_container_name": "MtxEventAppliedCatalogItem",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221
    }
  ],
  "appliedOfferArray": [
    {
      "appliedBundleIndex": 0,
      "mtx_container_name": "MtxEventAppliedOffer",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "productOfferExternalId": "PAYGO_VOICE_179_OFFER",
      "productOfferExternalOwnerId": "Test_TEF_Sub_01",
      "productOfferId": 179,
      "productOfferOwnerId": "0-1-5-515",
      "productOfferResourceId": 3,
      "productOfferVersion": 0,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    }
  ],
  "appliedTaxArray": [
    {
      "externalId": "A2",
      "mtx_container_name": "MtxEventAppliedTax",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "name": "A2 - German Standard VAT",
      "rate": 0.19
    }
  ],
  "balanceUpdateArray": [
    {
      "amount": 1.19,
      "balanceClassId": 978,
      "balanceEndTime": "65535-12-31T23:59:59.999999Z",
      "balanceResourceId": 3,
      "balanceStartTime": "2022-03-06T14:46:35.000000+02:00",
      "balanceTemplateId": 21065,
      "flags": 40,
      "mtx_container_name": "MtxBalanceUpdate",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221
    }
  ],
  "calledStationId": "4911111122",
  "callingStationId": "491761234567",
  "deleteCode": 1,
  "destinationCountry": "Germany",
  "duration": 250,
  "eventTypeArray": [
    1,
    3,
    2
  ],
  "flags": 0,
  "iddCCName": "DEU",
  "imsi": 262071234567890,
  "initiatorDeviceExternalId": "Test_TEF_Device_01",
  "initiatorDeviceId": "0-1-5-517",
  "initiatorId": "0-1-5-515",
  "initiatorPrimaryUserExternalId": "Test_TEF_User_01",
  "initiatorPrimaryUserId": "0-1-5-511",
  "initiatorType": "subscription",
  "lastUsageRoundingAmount": 0.0,
  "mccMncToUse": "26223",
  "meterUpdateArray": [
    {
      "amount": 1.0,
      "mtx_container_name": "MtxEventUsageQuantity",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "templateId": "test"
    }
  ],
  "mscAddress": "17123456",
  "mtx_ext_ver": 2,
  "mtx_sys_ver": 5221,
  "op": 3,
  "originationCCName": "DEU",
  "originationCCNumber": "1",
  "ratingGroup": 0,
  "sessionId": "MATRIXX-QA-TESTING.;1;8531187",
  "sessionMsgId": 2,
  "streamCursor": "00000000000001537459:00000",
  "usageQuantityList": [
    {
      "flags": 1,
      "msgAmount": 600.0,
      "mtx_container_name": "MtxEventUsageQuantity",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "quantityType": "actual_duration",
      "quantityUnit": "seconds",
      "ratingAmount": 600.0
    }
  ],
  "usageRoundingAmount": 0.0,
  "usageRoundingAmountUnit": 100,
  "usageUtcOffset": 0,
  "walletId": "0-1-5-516",
  "walletOwnerExternalId": "wallet Owner",
  "walletOwnerId": "0-1-5-515",
  "walletOwnerType": "subscription",
  "chargeList": [
    {
      "amount": "0.44",
      "appliedOfferIndex": 0,
      "balanceUpdateIndex": 0,
      "impactSource": "product_offer",
      "mtx_container_name": "MtxEventCharge",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "paymentType": 1,
      "updateType": 1,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    },
    {
      "amount": "0.08",
      "appliedOfferIndex": 0,
      "appliedTaxIndex": 0,
      "balanceUpdateIndex": 0,
      "impactSource": "product_offer",
      "mtx_container_name": "MtxEventCharge",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "paymentType": 1,
      "updateType": 14,
      "usageQuantity": 600.0,
      "usageQuantityUnit": 100
    }
  ],
  "appliedBundleArray": [
    {
      "appliedCatalogItemIndex": 0,
      "bundleExternalId": "Paygo_Blau_BaseProduct_201_BUNDLE",
      "bundleId": 201,
      "bundleResourceId": 1,
      "bundleVersion": 0,
      "mtx_container_name": "MtxEventAppliedBundle",
      "mtx_ext_ver": 2,
      "mtx_sys_ver": 5221,
      "purchasedBundleAttr": {
        "epcProductId": "ABCD123456",
        "epcProductName": "Paygo Blau BaseProduct 1",
        "glCode": "100000",
        "mtx_container_name": "TefPurchasedItemExtension",
        "mtx_ext_ver": 2,
        "mtx_sys_ver": 5221,
        "productTaxCode": "A2",
        "purchaseSequence": "00001",
        "serviceInstanceId": "SID_218839_1",
        "speedProfile": "1"
      }
    }
  ],
  "eventTime": "2023-06-08T09:23:53.387830Z",
  "roamingFlagId": "false",
  "destinationTypeId": "NM",
  "originationCCRegion": "OD",
  "iddCCRegion": "DD",
  "mtx_container_name": "TefTextEvent",
  "callTypeId": "MO",
  "tenantId": "SP910",
  "eventId": "Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03"
})
org.springframework.transaction.UnexpectedRollbackException: Transaction silently rolled back because it has been marked as rollback-only
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:752) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:654) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:407) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763) ~[spring-aop-5.3.27.jar:5.3.27]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708) ~[spring-aop-5.3.27.jar:5.3.27]
	at at.compax.rating.tef.listener.event.cdr.text.TefTextEvent$$EnhancerBySpringCGLIB$$268ca07c.run(<generated>) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.processEvent(TefEventListener.java:65) ~[classes/:?]
	at at.compax.rating.tef.listener.TefEventListener.listen(TefEventListener.java:51) ~[classes/:?]
	at at.compax.telefonica.listener.RetryListener.listenWithRetry(RetryListener.java:27) ~[kafka-retry-support-41.0.0-20230522.212146-2.jar:41.0.0-SNAPSHOT]
	at at.compax.rating.tef.listener.TefEventListener.listenWithRetry(TefEventListener.java:86) ~[classes/:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]
	at jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]
	at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]
	at java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119) ~[spring-messaging-5.3.27.jar:5.3.27]
	at org.springframework.kafka.listener.adapter.DelegatingInvocableHandler.invoke(DelegatingInvocableHandler.java:202) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:63) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2670) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2650) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2577) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2457) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2335) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2006) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1375) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1366) ~[spring-kafka-2.8.11.jar:2.8.11]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1257) ~[spring-kafka-2.8.11.jar:2.8.11]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) ~[?:?]
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264) ~[?:?]
	at java.util.concurrent.FutureTask.run(FutureTask.java) ~[?:?]
	at java.lang.Thread.run(Thread.java:829) ~[?:?]
2023-06-08 16:46:15 ERROR RetryListener:64 - Persisted event Perf_68194ee0-8ba5-4f15-8aa4-5a6bcfbede03 for retry

